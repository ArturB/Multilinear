<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-|
Module      : Tensor
Description : Tensor is a generic datatype to deal with linear algebra. May contain co- and contravariant indices as well. 
Copyright   : (c) Artur M. Brodzki, 2017
License     : 3-clause BSD
Maintainer  : artur.brodzki@gmail.com
Stability   : experimental
Portability : Windows/POSIX

-}</span><span>
</span><a name="line-11"></a><span>
</span><a name="line-12"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Multilinear</span><span class="hs-operator">.</span><span class="hs-identifier">Tensor</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-13"></a><span>  </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-type">T</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Multilinear.Tensor.html#el"><span class="hs-identifier hs-var">el</span></a><span class="hs-special">,</span><span> </span><a href="Multilinear.Tensor.html#ind"><span class="hs-identifier hs-var">ind</span></a><span>
</span><a name="line-14"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-15"></a><span>
</span><a name="line-16"></a><span class="hs-comment">{-| Tensor datatype -}</span><span>
</span><a name="line-17"></a><span class="hs-keyword">data</span><span> </span><a name="T"><a href="Multilinear.Tensor.html#T"><span class="hs-identifier">T</span></a></a><span> </span><a name="local-6989586621679020155"><a href="#local-6989586621679020155"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-18"></a><span>    </span><a name="T"><a href="Multilinear.Tensor.html#T"><span class="hs-identifier">T</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020156"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679020156"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-19"></a><span>  </span><span>
</span><a name="line-20"></a><span class="hs-comment">{-| Tensor component -}</span><span>
</span><a name="line-21"></a><span class="hs-identifier">el</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679020158"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020158"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-22"></a><a name="el"><a href="Multilinear.Tensor.html#el"><span class="hs-identifier">el</span></a></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679020159"><a href="#local-6989586621679020159"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020159"><span class="hs-identifier hs-var">f</span></a><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-comment">{-| Tensors can be added and multiplicated -}</span><span>
</span><a name="line-25"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679020162"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679020162"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-26"></a><span>    </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679020163"><a href="#local-6989586621679020163"><span class="hs-identifier">us1</span></a></a><span> </span><a name="local-6989586621679020164"><a href="#local-6989586621679020164"><span class="hs-identifier">ds1</span></a></a><span> </span><a name="local-6989586621679020165"><a href="#local-6989586621679020165"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-8214565720323790448"><span class="hs-operator">+</span></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679020166"><a href="#local-6989586621679020166"><span class="hs-identifier">us2</span></a></a><span> </span><a name="local-6989586621679020167"><a href="#local-6989586621679020167"><span class="hs-identifier">ds2</span></a></a><span> </span><a name="local-6989586621679020168"><a href="#local-6989586621679020168"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-27"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020163"><span class="hs-identifier hs-var">us1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679020166"><span class="hs-identifier hs-var">us2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679020164"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679020167"><span class="hs-identifier hs-var">ds2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-28"></a><span>            </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679020163"><span class="hs-identifier hs-var">us1</span></a><span> </span><a href="#local-6989586621679020164"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023736"><a href="#local-6989586621679023736"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679023737"><a href="#local-6989586621679023737"><span class="hs-identifier">dl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020165"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><a href="#local-6989586621679020168"><span class="hs-identifier hs-var">f2</span></a><span> </span><a href="#local-6989586621679023736"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679023737"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-29"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Tensors not compatible!&quot;</span><span>
</span><a name="line-30"></a><span>    </span><span>
</span><a name="line-31"></a><span>    </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679023772"><a href="#local-6989586621679023772"><span class="hs-identifier">us1</span></a></a><span> </span><a name="local-6989586621679023773"><a href="#local-6989586621679023773"><span class="hs-identifier">ds1</span></a></a><span> </span><a name="local-6989586621679023774"><a href="#local-6989586621679023774"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679023775"><a href="#local-6989586621679023775"><span class="hs-identifier">us2</span></a></a><span> </span><a name="local-6989586621679023776"><a href="#local-6989586621679023776"><span class="hs-identifier">ds2</span></a></a><span> </span><a name="local-6989586621679023777"><a href="#local-6989586621679023777"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-32"></a><span>        </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-var">us1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023775"><span class="hs-identifier hs-var">us2</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679023776"><span class="hs-identifier hs-var">ds2</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679023772"><span class="hs-identifier hs-var">us1</span></a><span> </span><a href="#local-6989586621679023773"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679023778"><a href="#local-6989586621679023778"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679023779"><a href="#local-6989586621679023779"><span class="hs-identifier">dl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023774"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679023778"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679023779"><span class="hs-identifier hs-var">dl</span></a><span> </span><span class="hs-glyph">-</span><span> </span><a href="#local-6989586621679023777"><span class="hs-identifier hs-var">f2</span></a><span> </span><a href="#local-6989586621679023778"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679023779"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-33"></a><span>        </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Tensors not compatible!&quot;</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span>    </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679023780"><a href="#local-6989586621679023780"><span class="hs-identifier">us1</span></a></a><span> </span><a name="local-6989586621679023781"><a href="#local-6989586621679023781"><span class="hs-identifier">ds1</span></a></a><span> </span><a name="local-6989586621679023782"><a href="#local-6989586621679023782"><span class="hs-identifier">f1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-8214565720323790447"><span class="hs-operator">*</span></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679023783"><a href="#local-6989586621679023783"><span class="hs-identifier">us2</span></a></a><span> </span><a name="local-6989586621679023784"><a href="#local-6989586621679023784"><span class="hs-identifier">ds2</span></a></a><span> </span><a name="local-6989586621679023785"><a href="#local-6989586621679023785"><span class="hs-identifier">f2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-36"></a><span>        </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023780"><span class="hs-identifier hs-var">us1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023783"><span class="hs-identifier hs-var">us2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679023781"><span class="hs-identifier hs-var">ds1</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679023784"><span class="hs-identifier hs-var">ds2</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-37"></a><span>            </span><span class="hs-glyph">\</span><a name="local-6989586621679023786"><a href="#local-6989586621679023786"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679023787"><a href="#local-6989586621679023787"><span class="hs-identifier">dl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679023782"><span class="hs-identifier hs-var">f1</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023780"><span class="hs-identifier hs-var">us1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023786"><span class="hs-identifier hs-var">ul</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023781"><span class="hs-identifier hs-var">ds1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023787"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679023785"><span class="hs-identifier hs-var">f2</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023780"><span class="hs-identifier hs-var">us1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023786"><span class="hs-identifier hs-var">ul</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679023781"><span class="hs-identifier hs-var">ds1</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679023787"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span>
</span><a name="line-38"></a><span>        </span><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span>    </span><span>
</span><a name="line-40"></a><span>    </span><a name="local-8214565720323790446"><span class="hs-identifier">abs</span></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679025059"><a href="#local-6989586621679025059"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-6989586621679025060"><a href="#local-6989586621679025060"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679025061"><a href="#local-6989586621679025061"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679025059"><span class="hs-identifier hs-var">us</span></a><span> </span><a href="#local-6989586621679025060"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679025062"><a href="#local-6989586621679025062"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679025063"><a href="#local-6989586621679025063"><span class="hs-identifier">dl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">abs</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025061"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025062"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679025063"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><a name="local-8214565720323790445"><span class="hs-identifier">signum</span></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679025064"><a href="#local-6989586621679025064"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-6989586621679025065"><a href="#local-6989586621679025065"><span class="hs-identifier">ds</span></a></a><span> </span><a name="local-6989586621679025066"><a href="#local-6989586621679025066"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a href="#local-6989586621679025064"><span class="hs-identifier hs-var">us</span></a><span> </span><a href="#local-6989586621679025065"><span class="hs-identifier hs-var">ds</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679025067"><a href="#local-6989586621679025067"><span class="hs-identifier">ul</span></a></a><span> </span><a name="local-6989586621679025068"><a href="#local-6989586621679025068"><span class="hs-identifier">dl</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">signum</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025066"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025067"><span class="hs-identifier hs-var">ul</span></a><span> </span><a href="#local-6989586621679025068"><span class="hs-identifier hs-var">dl</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-comment">{-| Returns tensor indices -}</span><span>
</span><a name="line-45"></a><span class="hs-identifier">ind</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-type">T</span></a><span> </span><a href="#local-6989586621679020157"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span class="hs-identifier hs-type">String</span><span class="hs-special">)</span><span>
</span><a name="line-46"></a><a name="ind"><a href="Multilinear.Tensor.html#ind"><span class="hs-identifier">ind</span></a></a><span> </span><span class="hs-special">(</span><a href="Multilinear.Tensor.html#T"><span class="hs-identifier hs-var">T</span></a><span> </span><a name="local-6989586621679020160"><a href="#local-6989586621679020160"><span class="hs-identifier">us</span></a></a><span> </span><a name="local-6989586621679020161"><a href="#local-6989586621679020161"><span class="hs-identifier">ds</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020160"><span class="hs-identifier hs-var">us</span></a><span class="hs-special">,</span><a href="#local-6989586621679020161"><span class="hs-identifier hs-var">ds</span></a><span class="hs-special">)</span></pre></body></html>